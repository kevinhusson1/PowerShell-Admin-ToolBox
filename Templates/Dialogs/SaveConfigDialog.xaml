<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="##loc:sp_builder.dialog_save_config_title##" Height="350" Width="500" WindowStartupLocation="CenterOwner" ResizeMode="NoResize" Background="{DynamicResource BackgroundControlBrush}">

    <Grid Margin="25">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Titre -->
            <RowDefinition Height="Auto"/>
            <!-- Nom -->
            <RowDefinition Height="Auto"/>
            <!-- Titre Sécu -->
            <RowDefinition Height="*"/>
            <!-- Liste Toggles -->
            <RowDefinition Height="Auto"/>
            <!-- Boutons -->
        </Grid.RowDefinitions>

        <!-- 1. Titre -->
        <TextBlock Grid.Row="0" Text="##loc:sp_builder.dialog_save_config_title##" Style="{DynamicResource H2Style}" Margin="0,0,0,20"/>

        <!-- 2. Nom de la config -->
        <StackPanel Grid.Row="1" Margin="0,0,0,20">
            <TextBlock Text="##loc:sp_builder.dialog_save_config_name##" Style="{DynamicResource LabelStyle}" Margin="0,0,0,5"/>
            <TextBox x:Name="ConfigNameBox" Style="{DynamicResource StandardTextBoxStyle}"/>
        </StackPanel>

        <!-- 3. Titre Sécu -->
        <StackPanel Grid.Row="2" Margin="0,0,0,10">
            <TextBlock Text="##loc:sp_builder.label_security_access##" FontWeight="SemiBold" Foreground="{DynamicResource PrimaryBrush}" FontSize="14"/>
            <TextBlock Text="##loc:sp_builder.dialog_save_config_desc##" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"/>
        </StackPanel>

        <!-- 4. Liste Toggles (Dynamique) -->
        <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto" MaxHeight="250" Margin="0,0,0,20">
            <StackPanel x:Name="GroupsContainer">
                <!-- Les CheckBox seront injectées ici par PowerShell avec le style ToggleSwitchStyle -->
            </StackPanel>
        </ScrollViewer>

        <!-- 5. Actions -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button x:Name="BtnCancel" Content="##loc:sp_builder.btn_cancel##" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,10,0" IsCancel="True"/>
            <Button x:Name="BtnSave" Content="##loc:sp_builder.btn_save_confirm##" Style="{DynamicResource PrimaryButtonStyle}" IsDefault="True"/>
        </StackPanel>
    </Grid>
</Window>
