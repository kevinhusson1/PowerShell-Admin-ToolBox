<Window 
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Name="ListUsersGraphWindow"
        Title="Liste des Utilisateurs (Microsoft Graph)" 
        Height="750" Width="1100" 
        WindowStartupLocation="CenterScreen"
        Background="#F5F7FA"
        UseLayoutRounding="True" 
        FontFamily="Segoe UI">
    <Grid Margin="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> 
            <RowDefinition Height="Auto"/> 
            <RowDefinition Height="*"/>    
            <RowDefinition Height="Auto"/> 
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" Margin="20,10,20,10" VerticalAlignment="Center">
            <Border Background="{DynamicResource PrimaryColor}" Width="60" Height="60" CornerRadius="30" DockPanel.Dock="Left" VerticalAlignment="Center">
                <TextBlock Text="ðŸ‘¥" FontSize="30" FontWeight="Bold" Foreground="White" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <StackPanel Margin="10,10,0,0" VerticalAlignment="Center">
                <TextBlock Text="Annuaire des Utilisateurs" Style="{DynamicResource H1Style}"/>
                <TextBlock Text="Consultation et filtrage des utilisateurs via Microsoft Graph" Style="{DynamicResource H2Style}"/>
            </StackPanel>
        </DockPanel>

        <Border Grid.Row="1" Background="White" BorderBrush="{DynamicResource LightGrayColor}" BorderThickness="1" Margin="20,0,20,10" Padding="15">
            <StackPanel Orientation="Vertical">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/> 
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Poste:" VerticalAlignment="Center" Style="{DynamicResource H4Style}" Margin="0,0,5,0"/>
                    <ComboBox x:Name="ComboBoxPoste" Grid.Column="1" MinWidth="180" Margin="0,0,20,0" 
                              Style="{DynamicResource StandardComboBoxStyle}" ItemContainerStyle="{DynamicResource StandardComboBoxItemStyle}"/>
                    <TextBlock Grid.Column="2" Text="Service:" VerticalAlignment="Center" Style="{DynamicResource H4Style}" Margin="0,0,5,0"/>
                    <ComboBox x:Name="ComboBoxDepartement" Grid.Column="3" MinWidth="180" Margin="0,0,20,0"
                              Style="{DynamicResource StandardComboBoxStyle}" ItemContainerStyle="{DynamicResource StandardComboBoxItemStyle}"/>
                    <Button x:Name="ButtonResetFilters" Grid.Column="4" Content="RÃ©initialiser Filtres" 
                            Style="{DynamicResource SecondaryButtonStyle}" MinWidth="120" Height="32"/>
                </Grid>
                <Grid Margin="0,10,0,0">
                     <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Rechercher (min 3 car.):" VerticalAlignment="Center" Style="{DynamicResource H4Style}" Margin="0,0,5,0"/>
                    <TextBox x:Name="TextBoxRecherche" Grid.Column="1" Height="32"
                             Style="{DynamicResource StandardTextBoxStyle}"/>
                </Grid>
            </StackPanel>
        </Border>

        <DataGrid x:Name="DataGridUsers" Grid.Row="2" Margin="20,0,20,0"
                  AutoGenerateColumns="False" IsReadOnly="True" CanUserAddRows="False" CanUserDeleteRows="False" CanUserSortColumns="True"
                  Style="{DynamicResource StandardDataGridStyle}"
                  ColumnHeaderStyle="{DynamicResource StandardDataGridColumnHeaderStyle}"
                  RowStyle="{DynamicResource StandardDataGridRowStyle}"
                  RowHeight="40"
                  BorderBrush="{DynamicResource LightGrayColor}" BorderThickness="1"> <!-- Hauteur de ligne fixe pour aider au TextWrapping -->
            <DataGrid.Resources>
                <!-- Style pour le TextBlock dans les cellules pour le Padding et TextWrapping -->
                <Style TargetType="TextBlock" x:Key="CellTextStyle">
                    <Setter Property="Padding" Value="5,0"/>
                    <Setter Property="TextWrapping" Value="NoWrap"/> <!-- Important pour que TextTrimming fonctionne -->
                    <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                    <Setter Property="VerticalAlignment" Value="Center"/>
                    <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=Text}"/> <!-- Affiche le texte complet en infobulle -->
                </Style>
                <!-- Style pour la cellule entiÃ¨re si plus de contrÃ´le est nÃ©cessaire (ex: alignement vertical du contenu) -->
                 <Style TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}"> <!-- HÃ©rite du style par dÃ©faut -->
                    <Setter Property="Padding" Value="5,3"/> <!-- Padding global pour la cellule -->
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                </Style>
            </DataGrid.Resources>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Nom d'Affichage" Binding="{Binding DisplayName}" Width="2*" ElementStyle="{StaticResource CellTextStyle}"/>
                <DataGridTextColumn Header="Email" Binding="{Binding Mail}" Width="2.5*" ElementStyle="{StaticResource CellTextStyle}"/>
                <DataGridTextColumn Header="Poste" Binding="{Binding JobTitle}" Width="1.5*" ElementStyle="{StaticResource CellTextStyle}"/>
                <DataGridTextColumn Header="Service" Binding="{Binding Department}" Width="1.5*" ElementStyle="{StaticResource CellTextStyle}"/>
                <DataGridTextColumn Header="TÃ©l. Pro" Binding="{Binding PrimaryBusinessPhone}" Width="1.2*" ElementStyle="{StaticResource CellTextStyle}"/>
                <DataGridTextColumn Header="Mobile" Binding="{Binding MobilePhone}" Width="1.2*" ElementStyle="{StaticResource CellTextStyle}"/>
                
                <DataGridTemplateColumn Header="" Width="Auto" MinWidth="35" MaxWidth="35">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button x:Name="ButtonInfo" Content="â„¹" Tag="{Binding}" 
                                    Style="{DynamicResource SecondaryButtonStyle}" 
                                    Width="28" Height="28" Padding="0" Margin="0" HorizontalAlignment="Center" VerticalAlignment="Center"
                                    ToolTip="Afficher les dÃ©tails de l'utilisateur"
                                    FontSize="14" FontWeight="Bold"/> <!-- Augmenter la taille de l'icÃ´ne -->
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <Border Grid.Row="3" Background="{DynamicResource LightGrayColor}" BorderThickness="0,1,0,0" Padding="20,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/> 
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="LabelStatus" Grid.Column="0" Text="Chargement des donnÃ©es..." 
                           VerticalAlignment="Center" Style="{DynamicResource StatusTextStyle}"/>
                <Button x:Name="ButtonExport" Grid.Column="1" Content="Exporter la Vue Actuelle" 
                        Style="{DynamicResource GreenButtonStyle}" Height="32" MinWidth="150"/>
            </Grid>
        </Border>
    </Grid>
</Window>